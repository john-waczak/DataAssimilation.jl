<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Sensativity Analysis · DataAssimilation.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://john-waczak.github.io/DataAssimilation.jl/dataAssimilation/sensativity/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.044/juliamono.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">DataAssimilation.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Data Assimilation</span><ul><li><a class="tocitem" href="../dataassim/">Data Assimilation Oveview</a></li><li><a class="tocitem" href="../kalman/">Kalman Filter</a></li><li><a class="tocitem" href="../ekf/">Extended Kalman Filter</a></li><li><a class="tocitem" href="../3dvar/">3d var</a></li><li><a class="tocitem" href="../4dvar/">4d var</a></li><li><a class="tocitem" href="../enkf/">Ensemble Kalman Filter</a></li><li class="is-active"><a class="tocitem" href>Sensativity Analysis</a><ul class="internal"><li><a class="tocitem" href="#Summary"><span>Summary</span></a></li></ul></li></ul></li><li><a class="tocitem" href="../../fdocs/">Function docs</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Data Assimilation</a></li><li class="is-active"><a href>Sensativity Analysis</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Sensativity Analysis</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/john-waczak/DataAssimilation.jl/blob/master/docs/src/dataAssimilation/sensativity.md#" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Sensativity-Analysis-for-Differential-Equations"><a class="docs-heading-anchor" href="#Sensativity-Analysis-for-Differential-Equations">Sensativity Analysis for Differential Equations</a><a id="Sensativity-Analysis-for-Differential-Equations-1"></a><a class="docs-heading-anchor-permalink" href="#Sensativity-Analysis-for-Differential-Equations" title="Permalink"></a></h1><p>Provided some model for a physical system in the form of a set of differential equations, a natural question is: How can we select the parameters for our model in order to get the best possible fit to some experimental data. Similarly, one may wonder what would happen to the prediction of your model if you were to slightly change the values of some parameters. In other words, how <em>sensative</em> is the output of our model to your choice of parameter values? </p><p>In the most general sense, we may frame the problem as follows. Suppose we have a model of the form </p><p class="math-container">\[\dfrac{du}{dt} = f(u,t,\theta)\]</p><p>Given this model, our goal is to optimize a cost function </p><p class="math-container">\[J(u; \theta) := \int_0^T g(u;\theta)dt\]</p><p>where <span>$g(u;\theta)$</span> is usually taken to be some <em>quadratic form</em>. </p><p>As an example, we might consider <span>$g(u\; \theta) = (u(t)-w(t))^T(u(t)-w(t))$</span> where <span>$w(t)$</span> denotes the vector of observations at time <span>$t$</span>. </p><p>Our goal then is to find out how <span>$J$</span> depends on the parameters <span>$\theta$</span>, in other words, to find <span>$\partial J / \partial \theta$</span>. To do this, we will use the method of Lagrange multipliers to generate a so called <em>adjoint equation</em> that enables us to find this derivative in a way that minimizes computational cost. As always, this method begins by adding a term that evaluates to 0 into our cost function: </p><p class="math-container">\[    \mathcal{L} := \int_0^T \left[ g(u;\theta) + \lambda^T(t)\left(f-\dfrac{du}{dt}\right) \right] dt\]</p><p>From this, we find </p><p class="math-container">\[\begin{aligned}
    \dfrac{\partial \mathcal{L}}{\partial \theta} &amp;:= \int_0^T\left[ \frac{\partial g}{\partial \theta} + \frac{\partial g}{u}\frac{\partial u}{\partial \theta} + \lambda^T(t)\left( \frac{\partial f}{\partial \theta} + \frac{\partial f}{\partial u}\frac{\partial u}{\partial \theta} - \frac{d}{dt}\frac{\partial u}{\partial \theta} \right)\right]dt \\ 
    &amp;= \int_0^T \left[ \frac{\partial g}{\partial \theta} + \lambda^T(t)\frac{\partial f}{\partial \theta} + \left( \frac{\partial g}{\partial u} + \lambda^T(t)\frac{\partial f}{\partial u} - \lambda^T(t)\frac{d}{dt} \right)\frac{\partial u}{\partial \theta} \right]dt
\end{aligned}\]</p><p>This reorganization is nice because the term <span>$\partial u/\partial \theta$</span> is the one thats <em>hard</em> to compute. Therefore, if we can make the terms in the paretheses evaluate to 0, we will be able to remove this pesky term. Let&#39;s use integration by parts to further rearrange by moving the <span>$d/dt$</span>.</p><p class="math-container">\[\begin{aligned}
    \int_0^T-\lambda^T(t)\frac{d}{dt}\frac{\partial u}{\partial \theta} dt &amp;= \left[-\lambda^T(t)\frac{\partial u}{\partial \theta} \right]_0^T + \int_0^T \frac{d\lambda^T(t)}{dt}\frac{\partial u}{\partial \theta}dt \\ 
    &amp;= \lambda^T(0)\frac{\partial u_0}{\partial \theta} - \lambda^T(T)\frac{\partial u(T)}{\partial \theta} + \int_0^T \left[ \frac{d\lambda}{dt} \right]^T\frac{\partial u}{\partial \theta}dt
\end{aligned}\]</p><p>so that plugging this back into our expression for <span>$\partial \mathcal{L}//\partial \theta$</span>, we obtain</p><p class="math-container">\[\frac{\partial \mathcal{L}}{\partial \theta} = \int_0^T \left[ \frac{\partial g}{\partial \theta} + \lambda^T\frac{\partial f}{\partial \theta} + \left( \frac{\partial g}{\partial u} + \lambda^T\frac{\partial f}{\partial u} + \left[\frac{d\lambda}{dt}\right]^T \right)\frac{\partial u}{\partial \theta}\right]dt + \lambda^T(0)\frac{\partial u_0}{\partial \theta} - \lambda^T(T)\frac{\partial u(T)}{\partial \theta}\]</p><p>Thus, forcing the nasty terms to dissappear is equivalent find the <span>$\lambda(t)$</span> subject to the differential equations </p><p class="math-container">\[\begin{aligned}
   \frac{\partial g}{\partial u} + \lambda^T(t)\frac{\partial f}{\partial u} + \frac{d\lambda^T(t)}{dt} &amp;= 0 \\ 
   \lambda^T(T) &amp;= 0
\end{aligned}\]</p><p>or by taking the transpose: </p><p class="math-container">\[\begin{aligned}
    \frac{d}{dt}\lambda &amp;= - \left[ \frac{\partial g}{\partial u} \right]^T - \left[ \frac{\partial f}{\partial u} \right]^T\lambda  \\ 
    \lambda(T) &amp;= 0
\end{aligned}\]</p><h2 id="Summary"><a class="docs-heading-anchor" href="#Summary">Summary</a><a id="Summary-1"></a><a class="docs-heading-anchor-permalink" href="#Summary" title="Permalink"></a></h2><p>To find the sensativities <span>$\partial J/\partial \theta$</span>, we perform the following: </p><ol><li>Integrate the model <span>$du/dt = f(u,t,\theta)$</span> forward to obtain <span>$u(t)$</span>.</li><li>Integrate the adjoint model <span>$d\lambda/dt = -(\partial f/ \partial u)^T\lambda - (\partial g / partial u)^T$</span> backwards in time from <span>$T$</span> to <span>$0$</span> to obtain <span>$\lambda(t)$</span>.</li><li>Evaluate <span>$\partial J / \partial \theta = \int_0^T\left( \partial g/ partial \theta + \lambda^T \partial f/\partial \theta\right)dt + \lambda^T(0)\partial u_0/\partial \theta$</span></li></ol></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../enkf/">« Ensemble Kalman Filter</a><a class="docs-footer-nextpage" href="../../fdocs/">Function docs »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.16 on <span class="colophon-date" title="Tuesday 17 May 2022 14:19">Tuesday 17 May 2022</span>. Using Julia version 1.7.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
